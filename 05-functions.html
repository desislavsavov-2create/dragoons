<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	
	<title>Document</title>
	<script>
		;(function() {

			window.onload = function() {

				function updateHtml(id, newHtml) {
					document.getElementById(id).innerHTML = newHtml;
				}

				function zeroPadded(input){
					if (input < 10) {
						return '0' + input;
					} else {
						return input;
					}
				}

				/* --- Clock ---*/

				(function clockThick(){
					var date = new Date();

					updateHtml('hours', zeroPadded(date.getHours()));
					updateHtml('minutes', zeroPadded(date.getMinutes()));
					updateHtml('seconds', zeroPadded(date.getSeconds()));

					setTimeout(clockThick, 1000)
				})();


				/* --- Stopwatch ---*/

				var elapsedTime = 0;
				var isStarted = false;
				var time;

				function stopwatch(){
					var hours, minutes, seconds;

					elapsedTime = elapsedTime + 1;

					time = setTimeout(stopwatch, 1000);
					render();
				}
				function render() {
					seconds = elapsedTime % 60;
					minutes = Math.floor(elapsedTime / 60) % 60;
					hours = Math.floor((elapsedTime / 60) / 60);

					updateHtml('sw-hours', zeroPadded(hours));
					updateHtml('sw-minutes', zeroPadded(minutes));
					updateHtml('sw-seconds', zeroPadded(seconds));
				}

				function startStopwatch() {
					if (!isStarted) {
						stopwatch();
						isStarted = true;
					}
				}

				function pauseStopwatch() {
					clearTimeout(time);
					isStarted = false;
				}

				function resetStopwatch() {
					elapsedTime = 0;
					pauseStopwatch();
					render();
				}

				var start = document.getElementsByClassName('start');
				var pause = document.getElementsByClassName('pause');
				var reset = document.getElementsByClassName('reset');

				start.onclick = startStopwatch;
				pause.onclick = pauseStopwatch;
				reset.onclick = resetStopwatch;

			}

		})();

		(function() {
			var actions = {};

			function addAction(action, callback) {
				if (typeof actions[action] === 'undefined') {
					actions[action] = [];
				}
				actions[action].push(callback);
			}


			function doAction(action) {
				for (var i = 0; i < actions[action].length; i++) {
					actions[action][i]();
				}
			}

			// Listen for "init"
			addAction("init", function () {
				console.log("Init has just happened. ");
			});
			 
			// Listen for "before_close"
			addAction("before_close", function () {
				console.log("window is about to close. ");
			});
			 
			// Another listener for before_close
			addAction("before_close", function () {
				console.log("Are you sure?");
			});
			 
			// say goodbye ...
			addAction("RIP", function () {
				console.log("we had a great time ... ");
			});
			 
			// At later point, the events are triggered
			// setTimeout(function() {
			// 	doAction("init"); // Trigger the init event
			// 	doAction("before_close"); // Trigger the before_close event
			// 	// don't trigger RIP event.
			// }, 500);
			
			/* 
				Expected output:
				* Init has just happened.
				* window is about to close.
				* Are you sure?
			*/
		})();

		(function() {
			var filters = {};

			function titleCase(title) {
				var words = title.split(' ');

				for (var i = 0; i < words.length; i++) {
					var word = words[i];

					word = word.charAt(0).toUpperCase() + word.substring(1);
					words[i] = word;
				}

				return words.join(' ');
			}

			function addFilter(target, callback) {
				if (typeof filters[target] === 'undefined') {
					filters[target] = [];
				}

				filters[target].push(callback);
			}

			function applyFilters(target, input) {
				for (var i = 0; i < filters[target].length; i++) {
					return input = filters[target][i](input);
				}
			}

			addFilter('title', titleCase);
			addFilter('title', function(title) {
				title = title.replace(/html/g, 'HTML');

				return title;
			});

			addFilter('content', titleCase);

			addFilter('tags', function(tag){
				tag = tag.replace(/ /g, ' ');

				return tag;
			});

			var text = 'ajdahskjsadh hd hakjd ha';

			console.log(applyFilters('title', text));
		})();
	</script>
</head>

<body>
	<h2>Clock</h2>
	<span id="hours">00</span>
	:
	<span id="minutes">00</span>
	:
	<span id="seconds">00</span>

	<div id="stopwatch1">
		<h2>Stopwatch 1</h2>

		<span class="sw-hours">00</span>
		:
		<span class="sw-minutes">00</span>
		:
		<span class="sw-seconds">00</span>
		
		<br />
		<button class="start">Start</button>
		<button class="pause">Pause</button>
		<button class="reset">Reset</button>
	</div><!-- /#stopwatch1 -->

	<div id="stopwatch1">
		<h2>Stopwatch 2</h2>

		<span class="sw-hours">00</span>
		:
		<span class="sw-minutes">00</span>
		:
		<span class="sw-seconds">00</span>
		
		<br />
		<button class="start">Start</button>
		<button class="pause">Pause</button>
		<button class="reset">Reset</button>
	</div><!-- /#stopwatch1 -->

	<div id="stopwatch1">
		<h2>Stopwatch 3</h2>

		<span class="sw-hours">00</span>
		:
		<span class="sw-minutes">00</span>
		:
		<span class="sw-seconds">00</span>
		
		<br />
		<button class="start">Start</button>
		<button class="pause">Pause</button>
		<button class="reset">Reset</button>
	</div><!-- /#stopwatch1 -->


</body>
</html>