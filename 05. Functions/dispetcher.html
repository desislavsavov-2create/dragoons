<html>
<head></head>
<body>
	<script>
		"use strict";

		(function() {
			window.onload = function() {
				var actions = {};

				var addAction = function( event, listener ) {
					if( typeof actions[event] === "undefined" ) {
						actions[event] = [];
					}

					actions[event].push( listener );
				}

				var doAction = function( event ) {
					for ( var i = 0; i < actions[event].length; i++ ) {
						actions[event][i]();
					}
				}

				// Listen for "init"
				addAction("init", function () {
				    console.log("Init has just happened. ");
				});
				 
				// Listen for "before_close"
				addAction("before_close", function () {
				    console.log("window is about to close. ");
				});
				 
				// Another listener for before_close
				addAction("before_close", function () {
				    console.log("Are you sure?");
				});
				 
				// say goodbye ... 
				addAction("RIP", function () {
				    console.log("we had a great time ... ");
				});
				
				 
				// At later point, the events are triggered
				setTimeout(function() {
				    doAction("init"); // Trigger the init event
				    doAction("before_close"); // Trigger the before_close event
				    // don't trigger RIP event.
				}, 500);
				/*
				 
				 Expected output: 
				  * Init has just happened.
				  * window is about to close. 
				  * Are you sure?
				 
				*/
			}
		})();
	</script>
</body>
</html>